<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="BaseLogApp.JumpsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:converters="clr-namespace:BaseLogApp.Converters"
    xmlns:maps="clr-namespace:Microsoft.Maui.Controls.Maps;assembly=Microsoft.Maui.Controls.Maps"
    Title="Salti"
    BackgroundColor="{AppThemeBinding Light=#FAFAFA, Dark=#111111}">

    <ContentPage.Resources>
        <converters:DateToLocalStringConverter x:Key="DateToLocal" Format="dd MMM yyyy" />
        <converters:NullOrEmptyToBoolConverter x:Key="HasText" />
    </ContentPage.Resources>

    <CollectionView
      ItemsSource="{Binding Jumps}"
      SelectionMode="None"
      ItemSizingStrategy="MeasureAllItems"
      EmptyView="Nessun salto registrato.">
        <CollectionView.ItemsLayout>
            <LinearItemsLayout Orientation="Vertical" ItemSpacing="8" />
        </CollectionView.ItemsLayout>

        <CollectionView.ItemTemplate>
            <DataTemplate>
                <ContentView BackgroundColor="{AppThemeBinding Light=#FAFAFA, Dark=#111}">
                    <Grid Padding="12"
            BackgroundColor="{AppThemeBinding Light=White, Dark=#1C1C1C}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <VerticalStackLayout Spacing="2">
                            <Label Text="{Binding ExitName}"
                 FontAttributes="Bold"
                 TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                            <Label Text="{Binding JumpDateUtc}"
                 TextColor="{AppThemeBinding Light=#222, Dark=#DDD}" />
                            <Label Text="{Binding LocationName}"
                 IsVisible="{Binding LocationName, Converter={StaticResource HasText}}"
                 TextColor="{AppThemeBinding Light=#222, Dark=#DDD}" />
                        </VerticalStackLayout>

                        <Grid Grid.Column="1"
              BackgroundColor="{AppThemeBinding Light=#EEE, Dark=#2A2A2A}">
                            <Image WidthRequest="64" HeightRequest="64"
                 Aspect="AspectFill"
                 Source="{Binding Thumbnail}" />
                            <Label Text="No Img" HorizontalOptions="Center" VerticalOptions="Center"
                 IsVisible="{Binding Thumbnail, Converter={StaticResource HasText}, ConverterParameter=Invert}"
                 TextColor="{AppThemeBinding Light=#555, Dark=#BBB}" />
                        </Grid>
                    </Grid>
                </ContentView>
            </DataTemplate>
        </CollectionView.ItemTemplate>

    </CollectionView>
</ContentPage>
